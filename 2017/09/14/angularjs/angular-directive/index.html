<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>angularJS中的指令directive | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="angularJS中的指令directive">
<meta name="keywords" content="angular, angularjs">
<meta property="og:type" content="article">
<meta property="og:title" content="angularJS中的指令directive">
<meta property="og:url" content="http://yoursite.com/2017/09/14/angularjs/angular-directive/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="angularJS中的指令directive">
<meta property="og:updated_time" content="2017-09-14T01:54:04.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="angularJS中的指令directive">
<meta name="twitter:description" content="angularJS中的指令directive">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-angularjs/angular-directive" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/09/14/angularjs/angular-directive/" class="article-date">
  <time datetime="2017-09-14T01:30:09.000Z" itemprop="datePublished">2017-09-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/angularjs/">angularjs</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      angularJS中的指令directive
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>原文：</p>
<p><a href="http://blog.jobbole.com/62249/" target="_blank" rel="external">AngularJS 指令实践指南（一）</a></p>
<p><a href="http://blog.jobbole.com/62999/" target="_blank" rel="external">AngularJS 指令实践指南（二）</a></p>
<h4 id="一、创建自定义指令"><a href="#一、创建自定义指令" class="headerlink" title="一、创建自定义指令"></a>一、创建自定义指令</h4><pre><code>var app = angular.module(&apos;myapp&apos;, []);

app.directive(&apos;rabbitHeader&apos;, function() {
  return {
      restrict: &apos;AE&apos;,
      replace: &apos;true&apos;,
      template: &apos;&lt;h3&gt;Hello World!!&lt;/h3&gt;&apos;
  };
});
</code></pre><h5 id="1、表现形式"><a href="#1、表现形式" class="headerlink" title="1、表现形式"></a>1、表现形式</h5><ul>
<li><p>html元素名</p>
<pre><code>&lt;rabbit-header&gt;&lt;/rabbit-header&gt;
</code></pre></li>
<li><p>元素的属性</p>
<pre><code>&lt;div rabbit-header&gt;&lt;/div&gt;
</code></pre></li>
<li><p>类名        </p>
<pre><code>&lt;div class=&quot;rabbit-header&quot;&gt;&lt;/div&gt;    
</code></pre></li>
<li><p>注释</p>
<pre><code>&lt;!-- directive: rabbit-header --&gt;
</code></pre></li>
</ul>
<h5 id="2、属性"><a href="#2、属性" class="headerlink" title="2、属性"></a>2、属性</h5><p><em>restrict:</em></p>
<ul>
<li><p>A：只限属性使用</p>
</li>
<li><p>C：只限类名使用</p>
</li>
<li><p>E：只限元素名使用</p>
</li>
<li><p>M：只限注释使用</p>
</li>
</ul>
<p><em>template | templateUrl</em></p>
<ul>
<li><p>template: 不一定要是简单的字符串，可以包含其它指令或表达式{} 等</p>
</li>
<li><p>templateUrl: 指向模板的一个地址</p>
</li>
</ul>
<p><em>replace</em></p>
<ul>
<li><p>true: 生成的html内容会替换掉定义此指令的html</p>
</li>
<li><p>false: 生成的html内容会插入到定义此指令的元素中</p>
</li>
</ul>
<h5 id="3、Link函数和Scope"><a href="#3、Link函数和Scope" class="headerlink" title="3、Link函数和Scope"></a>3、Link函数和Scope</h5><ul>
<li><p>默认情况下指令不会创建新的子scope。</p>
</li>
<li><p>如果指令存在于一个controller下，它会使用这个contoller的scope。</p>
</li>
<li><p>指令的scope在link函数中使用。</p>
</li>
</ul>
<p>index.html</p>
<pre><code>&lt;body ng-controller=&quot;MainCtrl&quot;&gt;
  &lt;input type=&quot;text&quot; ng-model=&quot;color&quot; placeholder=&quot;Enter a color&quot; /&gt;
  &lt;hello-world&gt;&lt;/hello-world&gt;
&lt;/body&gt;
</code></pre><p>app.js</p>
<pre><code>app.directive(&apos;helloWorld&apos;, function() {
  return {
    restrict: &apos;AE&apos;,
    replace: true,
    template: &apos;&lt;p style=&quot;background-color:{{color}}&quot;&gt;Hello World&apos;,
    link: function(scope, elem, attrs) {
      elem.bind(&apos;click&apos;, function() {
        elem.css(&apos;background-color&apos;, &apos;white&apos;);
        scope.$apply(function() {
          scope.color = &quot;white&quot;;
        });
      });
      elem.bind(&apos;mouseover&apos;, function() {
        elem.css(&apos;cursor&apos;, &apos;pointer&apos;);
      });
    }
  };
});
</code></pre><p>link函数中的三个参数：</p>
<ul>
<li><p>scope - 在这个例子中，指令的scope就是controller的scope。</p>
</li>
<li><p>ele - 指令的jQLite(jQuery的子集)包装DOM元素。如果你在引入AngularJS之前引入了jQuery，那么这个元素就是jQuery元素，而不是jQLite元素。由于这个元素已经被jQuery/jQLite包装了，所以我们就在进行DOM操作的时候就不需要再使用 $()来进行包装。</p>
</li>
<li><p>attr - 一个包含了指令所在元素的属性的标准化的参数对象。举个例子，你给一个HTML元素添加了一些属性：，那么可以在 link 函数中通过 attrs.someAttribute 来使用它。</p>
</li>
</ul>
<p>link函数主要用来为DOM元素添加事件监听、监视模型属性变化、以及更新DOM。</p>
<p>在上面的指令代码片段中，我们添加了两个事件， click，和 mouseover。click 处理函数用来重置的背景色，而 mouseover 处理函数改变鼠标为 pointer。在模板中有一个表达式 {color}，当父scope中的 color 发生变化时，它用来改变 Hello World 文字的背景色。 这个plunker演示了这些概念</p>
<h5 id="4、compile函数"><a href="#4、compile函数" class="headerlink" title="4、compile函数"></a>4、compile函数</h5><p>compile 函数在 link 函数被执行之前用来做一些DOM改造。它接收下面的参数：</p>
<ul>
<li>tElement – 指令所在的元素</li>
<li>attrs – 元素上赋予的参数的标准化列表</li>
</ul>
<p>要注意的是 compile 函数不能访问 scope，并且必须返回一个 link 函数。但是如果没有设置 compile 函数，你可以正常地配置 link 函数，（有了compile，就不能用link，link函数由compile返回）。compile函数可以写成如下的形式：</p>
<pre><code>app.directive(&apos;test&apos;, function() {
  return {
    compile: function(tElem,attrs) {
      //do optional DOM transformation here
      return function(scope,elem,attrs) {
        //linking function here
      };
    }
  };
});
</code></pre><p>大多数的情况下，你只需要使用 link 函数。这是因为大部分的指令只需要考虑注册事件监听、监视模型、以及更新DOM等，这些都可以在 link 函数中完成。 但是对于像 ng-repeat 之类的指令，需要克隆和重复 DOM 元素多次，在 link 函数执行之前由 compile 函数来完成。这就带来了一个问题，为什么我们需要两个分开的函数来完成生成过程，为什么不能只使用一个？要回答好这个问题，我们需要理解指令在Angular中是如何被编译的！</p>
<h5 id="5、指令是如何被编译的"><a href="#5、指令是如何被编译的" class="headerlink" title="5、指令是如何被编译的"></a>5、指令是如何被编译的</h5><p>1、编译阶段 compile</p>
<ul>
<li><p>angular应用启动后，$compile服务遍历所有DOM元素。</p>
</li>
<li><p>所有指令都被识别后，angular执行他们的compile方法。</p>
</li>
<li><p>compile 方法返回一个 link 函数，被添加到稍后执行的 link 函数列表中。</p>
</li>
</ul>
<p>2、链接阶段 linking</p>
<ul>
<li><p>所有收集到的link函数都将被一一执行。</p>
</li>
<li><p>指令创造出来的模板会在正确的scope下被解析和处理，然后返回具有事件响应的真实的DOM节点。</p>
</li>
</ul>
<h5 id="6、改变指令的Scope"><a href="#6、改变指令的Scope" class="headerlink" title="6、改变指令的Scope"></a>6、改变指令的Scope</h5><p>默认情况下，指令获取它父节点的controller的scope。</p>
<p>如果将父controller的scope暴露给指令，那么他们可以随意地修改 scope 的属性。</p>
<p>在某些情况下，你的指令希望能够添加一些仅限内部使用的属性和方法。但是如果我们在父的scope中添加，会污染父scope。</p>
<p>所以我们可以选择以下两种方式：</p>
<ul>
<li><p>一个子scope – 这个scope原型继承子父scope。</p>
<pre><code>app.directive(&apos;helloWorld&apos;, function() {
  return {
    scope: true,  // use a child scope that inherits from parent
    restrict: &apos;AE&apos;,
    replace: &apos;true&apos;,
    template: &apos;&lt;h3&gt;Hello World!!&lt;/h3&gt;&apos;
  };
});
</code></pre></li>
<li><p>一个隔离的scope – 一个孤立存在不继承自父scope的scope。</p>
<pre><code>app.directive(&apos;helloWorld&apos;, function() {
  return {
    scope: {},  // use a new isolated scope
    restrict: &apos;AE&apos;,
    replace: &apos;true&apos;,
    template: &apos;&lt;h3&gt;Hello World!!&lt;/h3&gt;&apos;
  };
});
</code></pre></li>
</ul>
<p>这个指令使用了一个隔离的scope。</p>
<p>隔离的scope在我们想要创建可重用的指令的时候是非常有好处的。</p>
<p>通过使用隔离的scope，我们能够保证我们的指令是自包含的，可以被很容易的插入到HTML应用中。</p>
<p>它内部不能访问父的scope，所保证了父scope不被污染。</p>
<p>在我们的 helloWorld 指令例子中，如果我们将 scope 设置成 {}，那么上面的代码将不会工作。 它会创建一个新的隔离的scope，那么相应的表达式 { color } 会指向到这个新的scope中，它的值将是 undefined.</p>
<p>使用隔离的scope并不意味着我们完全不能访问父scope的属性。其实有一些技术可以允许我们访问父scope的属性，甚至监视他们的变化。</p>
<h4 id="二、隔离scope与父scope通信"><a href="#二、隔离scope与父scope通信" class="headerlink" title="二、隔离scope与父scope通信"></a>二、隔离scope与父scope通信</h4><h5 id="1、隔离scope与父scope之间的数据绑定"><a href="#1、隔离scope与父scope之间的数据绑定" class="headerlink" title="1、隔离scope与父scope之间的数据绑定"></a>1、隔离scope与父scope之间的数据绑定</h5><p>假设我们已经初始化完成app这个变量所指向的Angular模块。那么我们的 helloWorld 指令如下面代码所示：</p>
<pre><code>app.directive(&apos;helloWorld&apos;, function() {
  return {
    scope: {},
    restrict: &apos;AE&apos;,
    replace: true,
    template: &apos;&lt;p style=&quot;background-color:{{color}}&quot;&gt;Hello World&lt;/p&gt;&apos;,
    link: function(scope, elem, attrs) {
      elem.bind(&apos;click&apos;, function() {
        elem.css(&apos;background-color&apos;,&apos;white&apos;);
        scope.$apply(function() {
          scope.color = &quot;white&quot;;
        });
      });
      elem.bind(&apos;mouseover&apos;, function() {
        elem.css(&apos;cursor&apos;, &apos;pointer&apos;);
      });
    }
  };
});
</code></pre><p>使用这个指令的HTML标签如下：</p>
<pre><code>&lt;body ng-controller=&quot;MainCtrl&quot;&gt;
  &lt;input type=&quot;text&quot; ng-model=&quot;color&quot; placeholder=&quot;Enter a color&quot;/&gt;
  &lt;hello-world/&gt;
&lt;/body&gt;
</code></pre><p>上面的代码现在是不能工作的。因为我们用了一个隔离的scope，指令内部的 {color} 表达式被隔离在指令内部的scope中(不是父scope)。</p>
<p>但是外面的输入框元素中的 ng-model 指令是指向父scope中的 color 属性的。</p>
<p>所以，我们需要一种方式来绑定隔离scope和父scope中的这两个参数。</p>
<p>在Angular中，这种数据绑定可以通过为指令所在的HTML元素添加属性和在指令定义对象中配置相应的 scope 属性来实现。</p>
<p>让我们来细究一下建立数据绑定的几种方式。</p>
<h5 id="选择一：使用-实现单向文本绑定"><a href="#选择一：使用-实现单向文本绑定" class="headerlink" title="选择一：使用 @ 实现单向文本绑定"></a>选择一：使用 @ 实现单向文本绑定</h5><p>在下面的指令定义中，我们指定了隔离scope中的属性 color 绑定到指令所在HTML元素上的参数 colorAttr。</p>
<p>在HTML标记中，你可以看到 {color}表达式被指定给了 color-attr 参数。当表达式的值发生改变时，color-attr 参数也跟着改变。隔离scope中的 color 属性的值也相应地被改变。</p>
<pre><code>app.directive(&apos;helloWorld&apos;, function() {
  return {
    scope: {
      color: &apos;@colorAttr&apos;
    },
    ....
    // the rest of the configurations
  };
});
</code></pre><p>更新后的HTML标记代码如下：</p>
<pre><code>&lt;body ng-controller=&quot;MainCtrl&quot;&gt;
  &lt;input type=&quot;text&quot; ng-model=&quot;color&quot; placeholder=&quot;Enter a color&quot;/&gt;
  &lt;hello-world color-attr=&quot;{{color}}&quot;/&gt;
&lt;/body&gt;
</code></pre><p>我们称这种方式为单项绑定，是因为在这种方式下，你只能将字符串(使用表达式)传递给参数。</p>
<p>当父scope的属性变化时，你的隔离scope模型中的属性值跟着变化。你甚至可以在指令内部监控这个scope属性的变化，并且触发一些任务。</p>
<p>然而，反向的传递并不工作。你不能通过对隔离scope属性的操作来改变父scope的值。</p>
<p>注意点：<br>当隔离scope属性和指令元素参数的名字一样时，你可以以更简单的方式设置scope绑定：</p>
<pre><code>app.directive(&apos;helloWorld&apos;, function() {
  return {
    scope: {
      color: &apos;@&apos;
    },
    ....
    // the rest of the configurations
  };
});
</code></pre><p>相应使用指令的HTML代码如下：</p>
<hello-world color="">

<h5 id="选择二：使用-实现双向绑定"><a href="#选择二：使用-实现双向绑定" class="headerlink" title="选择二：使用 = 实现双向绑定"></a>选择二：使用 = 实现双向绑定</h5><p>让我们将指令的定义改变成下面的样子：</p>
<pre><code>app.directive(&apos;helloWorld&apos;, function() {
  return {
    scope: {
      color: &apos;=&apos;
    },
    ....
    // the rest of the configurations
  };
});
</code></pre><p>相应的HTML修改如下：</p>
<pre><code>&lt;body ng-controller=&quot;MainCtrl&quot;&gt;
  &lt;input type=&quot;text&quot; ng-model=&quot;color&quot; placeholder=&quot;Enter a color&quot;/&gt;
  &lt;hello-world color=&quot;color&quot;/&gt;
&lt;/body&gt;
</code></pre><p>与 @ 不同，这种方式让你能够给属性指定一个真实的scope数据模型，而不是简单的字符串。</p>
<p>这样你就可以传递简单的字符串、数组、甚至复杂的对象给隔离scope。</p>
<p>同时，还支持双向的绑定。每当父scope属性变化时，相对应的隔离scope中的属性也跟着改变，反之亦然。</p>
<p>和之前的一样，你也可以监视这个scope属性的变化。</p>
<h5 id="选择三：使用-amp-在父scope中执行函数"><a href="#选择三：使用-amp-在父scope中执行函数" class="headerlink" title="选择三：使用 &amp; 在父scope中执行函数"></a>选择三：使用 &amp; 在父scope中执行函数</h5><p>有时候从隔离scope中调用父scope中定义的函数是非常有必要的。为了能够访问外部scope中定义的函数，我们使用 &amp;。</p>
<p>比如我们想要从指令内部调用 changColor() 方法。下面的代码告诉我们该怎么做：</p>
<pre><code>app.directive(&apos;helloWorld&apos;,function(){
  return{
    scope:{
      color:&apos;=&apos;,
      changeColor:&apos;&amp;&apos;,
    },
    ...
  }
});
</code></pre><p>相应的HTML代码如下：</p>
<pre><code>&lt;body ng-controller=&quot;MainCtrl&quot;&gt;
    &lt;input type=&quot;text&quot; ng-model=&quot;color&quot; placeholder=&quot;Enter a color&quot;/&gt;
    &lt;hello-world color=&quot;color&quot; change-color=&apos;change()&apos;/&gt;
&lt;/body&gt;
</code></pre><p>这个 <a href="http://plnkr.co/edit/k4scWKwtGBJw7lfKGqVJ?p=preview" target="_blank" rel="external">Plunker</a> 例子对上面的概念做了很好的诠释。</p>
<h5 id="2、父scope、子scope以及隔离scope的区别"><a href="#2、父scope、子scope以及隔离scope的区别" class="headerlink" title="2、父scope、子scope以及隔离scope的区别"></a>2、父scope、子scope以及隔离scope的区别</h5><p>下面的这个原则也许可以帮助你为你的指令选择正确的scope。</p>
<ul>
<li><p>父scope(scope: false) – 这是默认情况。如果你的指令不操作父scoe的属性，你就不需要一个新的scope。这种情况下是可以使用父scope的。</p>
</li>
<li><p>子scope(scope: true) – 这会为指令创建一个新的scope，并且原型继承自父scope。如果你的指令scope中的属性和方法与其他的指令以及父scope都没有关系的时候，你应该创建一个新scope。在这种方式下，你同样拥有父scope中所定义的属性和方法。</p>
</li>
<li><p>隔离scope(scope:{}) – 这就像一个沙箱！当你创建的指令是自包含的并且可重用的，你就需要使用这种scope。你在指令中会创建很多scope属性和方法，它们仅在指令内部使用，永远不会被外部的世界所知晓。如果是这样的话，隔离的scope是更好的选择。隔离的scope不会继承父scope。</p>
</li>
</ul>
<h4 id="三、Transclusion（嵌入）"><a href="#三、Transclusion（嵌入）" class="headerlink" title="三、Transclusion（嵌入）"></a>三、Transclusion（嵌入）</h4><p>Transclusion可以让我们的指令包含任意内容的方法。</p>
<p>如果你在指令定义中设置 transclude:true，一个新的嵌入的scope会被创建，它原型继承自父scope。</p>
<p>如果你想要你的指令使用隔离的scope，但是它所包含的内容能够在父scope中执行，transclusion也可以帮忙。</p>
<h5 id="1、demo"><a href="#1、demo" class="headerlink" title="1、demo"></a>1、demo</h5><p>假设我们注册一个如下的指令：</p>
<pre><code>app.directive(&apos;outputText&apos;, function() {
  return {
    transclude: true,
    scope: {},
    template: &apos;&lt;div ng-transclude&gt;&lt;/div&gt;&apos;
  };
});
</code></pre><p>它使用如下：</p>
<pre><code>&lt;div output-text&gt;
  &lt;p&gt;Hello {{name}}&lt;/p&gt;
&lt;/div&gt;
</code></pre><p>在这个例子中DOM内容 </p><p>Hello {name}</p> 被提取和放置到 <div ng-transclude=""></div> 内部。<p></p>
<p>表达式{name}所对应的属性是在父scope中被定义的，而非子scope。</p>
<p>你可以在这个 <a href="http://plnkr.co/edit/YQBPB9cvGgJiYMuIjzTw?p=preview" target="_blank" rel="external">Plunker</a> 例子中做一些实验。</p>
<h5 id="2、transclude-’element’-和-transclude-true的区别"><a href="#2、transclude-’element’-和-transclude-true的区别" class="headerlink" title="2、transclude:’element’ 和 transclude:true的区别"></a>2、transclude:’element’ 和 transclude:true的区别</h5><p>有时候我我们要嵌入指令元素本身，而不仅仅是它的内容。在这种情况下，我们需要使用 transclude:’element’。</p>
<p>它和 transclude:true 不同，它将标记了 ng-transclude 指令的元素一起包含到了指令模板中。</p>
<p>使用transclusion，你的link函数会获得一个名叫 transclude 的链接函数，这个函数绑定了正确的指令scope，并且传入了另一个拥有被嵌入DOM元素拷贝的函数。</p>
<p>你可以在这个 transclude 函数中执行比如修改元素拷贝或者将它添加到DOM上等操作。 类似 ng-repeat 这样的指令使用这种方式来重复DOM元素。</p>
<p>仔细研究一下这个Plunker，它使用这种方式复制了DOM元素，并且改变了第二个实例的背景色。</p>
<p>同样需要注意的是，在使用 transclude:’element’的时候，指令所在的元素会被转换成HTML注释。</p>
<p>所以，如果你结合使用 transclude:’element’ 和 replace:false，那么指令模板本质上是被添加到了注释的innerHTML中——也就是说其实什么都没有发生！</p>
<p>相反，如果你选择使用 replace:true，指令模板会替换HTML注释，那么一切就会如果所愿的工作。</p>
<p>使用 replade:false 和 transclue:’element’有时候也是有用的，比如当你需要重复DOM元素但是并不想保留第一个元素实例（它会被转换成注释）的情况下。对这块还有疑惑的同学可以阅读stackoverflow上的这篇讨论，介绍的比较清晰。</p>
<h4 id="四、controller-函数和-require"><a href="#四、controller-函数和-require" class="headerlink" title="四、controller 函数和 require"></a>四、controller 函数和 require</h4><p>如果想让指令与指令交互，就要用到controller函数。比如有些情况下，你需要通过组合两个指令来实现一个UI组件。那么你可以通过如下的方式来给指令添加一个 controller 函数。</p>
<pre><code>app.directive(&apos;outerDirective&apos;, function() {
  return {
    scope: {},
    restrict: &apos;AE&apos;,
    controller: function($scope, $compile, $http) {
      // $scope is the appropriate scope for the directive
      this.addChild = function(nestedDirective) { // this refers to the controller
        console.log(&apos;Got the message from nested directive:&apos; + nestedDirective.message);
      };
    }
  };
});
</code></pre><p>这个代码为一个名叫 outerDirective的指令添加了controller。</p>
<p>当另一个指令 innerDirective 想要与指令outerDirective交互时，innterDirective 需要声明对 outerDirective 的 controller 实例的引用(require)。</p>
<p>可以通过如下的方式实现：</p>
<pre><code>app.directive(&apos;innerDirective&apos;, function() {
  return {
    scope: {},
    restrict: &apos;AE&apos;,
    require: &apos;^outerDirective&apos;,
    link: function(scope, elem, attrs, controllerInstance) {
      //the fourth argument is the controller instance you require
      scope.message = &quot;Hi, Parent directive&quot;;
      controllerInstance.addChild(scope);
    }
  };
});
</code></pre><p>相应的HTML代码如下：</p>
<pre><code>&lt;outer-directive&gt;
  &lt;inner-directive&gt;&lt;/inner-directive&gt;
&lt;/outer-directive&gt;
</code></pre><p>require: ‘^outerDirective’ 告诉Angular在元素以及它的父元素outerDirective中搜索controller。</p>
<p>这样被找到的 controller 实例会作为第四个参数controllerInstance被传入到 link 函数中。</p>
<p>在我们的例子中，我们将嵌入的指令的scope发送给父亲指令。</p>
<p>如果你想尝试这个代码的话，请在开启浏览器控制台的情况下打开这个<a href="http://plnkr.co/edit/NMWGE6l9p1tBZh3jCfKn?p=preview" target="_blank" rel="external">Plunker</a>。</p>
<p>同时，<a href="https://docs.angularjs.org/guide/directive" target="_blank" rel="external">这篇Angular官方文档</a>上的最后部分给了一个非常好的关于指令交互的例子，是非常值得一读的。</p>
<h4 id="五、一个记事本的应用"><a href="#五、一个记事本的应用" class="headerlink" title="五、一个记事本的应用"></a>五、一个记事本的应用</h4><p>这一部分，我们使用Angular指令创建一个简单的记事本应用。我们会使用HTML5的 localStorage 来存储笔记。</p>
<p>我们会创建一个展现记事本的指令。</p>
<p>用户可以查看他/她创建过的笔记记录。当他点击 add new 按钮的时候，记事本会进入可编辑状态，并且允许创建新的笔记。当点击 back 按钮的时候，新的笔记会被自动保存。笔记的保存使用了一个名叫 noteFactory 的工厂类，它使用了 localStorage。</p>
<p>你可以从<a href="https://github.com/jsprodotcom/source/blob/master/AngularJS_Note_Taker-source_code.zip" target="_blank" rel="external">GitHub</a>上下到这个Demo的源代码。</p>
<h4 id="六、总结"><a href="#六、总结" class="headerlink" title="六、总结"></a>六、总结</h4><p>一个很重要的点需要注意的是，任何使用jQuery能做的事情，我们都能用Angular指令来做到，并且使用更少的代码。</p>
<p>所以，在使用jQuery之前，请考虑一下我们能否在不进行DOM操作的情况下以更好的方式来完成任务。试着使用Angular来最小化jQuery的使用吧。</p>
</hello-world>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/09/14/angularjs/angular-directive/" data-id="cji15cnnq0001u0fymlfucwp4" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/angular/">angular</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2017/09/14/angularjs/angular-apply/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          理解数据绑定过程 - `$watch`, `$apply`和`$digest`
        
      </div>
    </a>
  
  
    <a href="/2017/09/14/angularjs/angular-errors/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">angular应用中常见问题记录</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/angularjs/">angularjs</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/bootstrap/">bootstrap</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/github/">github</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/">java</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/maven/">maven</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/mybatis/">mybatis</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/react/">react</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/spring/">spring</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/springmvc/">springmvc</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/ssm/">ssm</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/转载/">转载</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/随笔/">随笔</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/IO/">IO</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/angular/">angular</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/api/">api</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/bootstrap/">bootstrap</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/collecionsFramework/">collecionsFramework</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/css-grid/">css-grid</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/github/">github</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jsp/">jsp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/maven/">maven</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mybatis/">mybatis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/react/">react</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/reflect/">reflect</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/regex/">regex</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/servlet/">servlet</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/session-cookie/">session cookie</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spring/">spring</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/springmvc/">springmvc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ssm/">ssm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/thread/">thread</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/足球/">足球</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/IO/" style="font-size: 20px;">IO</a> <a href="/tags/angular/" style="font-size: 17.14px;">angular</a> <a href="/tags/api/" style="font-size: 14.29px;">api</a> <a href="/tags/bootstrap/" style="font-size: 10px;">bootstrap</a> <a href="/tags/collecionsFramework/" style="font-size: 15.71px;">collecionsFramework</a> <a href="/tags/css-grid/" style="font-size: 10px;">css-grid</a> <a href="/tags/github/" style="font-size: 10px;">github</a> <a href="/tags/jsp/" style="font-size: 12.86px;">jsp</a> <a href="/tags/maven/" style="font-size: 12.86px;">maven</a> <a href="/tags/mybatis/" style="font-size: 17.14px;">mybatis</a> <a href="/tags/react/" style="font-size: 10px;">react</a> <a href="/tags/reflect/" style="font-size: 10px;">reflect</a> <a href="/tags/regex/" style="font-size: 10px;">regex</a> <a href="/tags/servlet/" style="font-size: 11.43px;">servlet</a> <a href="/tags/session-cookie/" style="font-size: 10px;">session cookie</a> <a href="/tags/spring/" style="font-size: 18.57px;">spring</a> <a href="/tags/springmvc/" style="font-size: 14.29px;">springmvc</a> <a href="/tags/ssm/" style="font-size: 10px;">ssm</a> <a href="/tags/thread/" style="font-size: 11.43px;">thread</a> <a href="/tags/足球/" style="font-size: 10px;">足球</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">May 2016</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2018/06/05/java/maven/maven-3/">第三章 maven拆分ssm</a>
          </li>
        
          <li>
            <a href="/2018/06/03/java/maven/maven-2/">第二章 maven整合smm</a>
          </li>
        
          <li>
            <a href="/2018/06/01/java/maven/maven-1/">第一章 maven管理工具</a>
          </li>
        
          <li>
            <a href="/2018/05/26/java/ssm/ssm-1/">第一章 搭建SSM开发环境</a>
          </li>
        
          <li>
            <a href="/2018/05/24/java/springmvc/springmvc-4/">第四章 springmvc核心技术</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>